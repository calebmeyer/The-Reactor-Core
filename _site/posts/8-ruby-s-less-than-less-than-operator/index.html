<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>The Reactor Core</title>
        <style media="screen">
            /* note: not actually a sass file, just using that for syntax highlighting */

/*
 * main green: #d3fc05
 */

body {
    background: #101010;
    color: #c8d1b8;
    font-family: gitan-latin; Tahoma, Verdana, sans-serif;
    font-size: 20px;
    line-height: 1.6;
    padding: 50px;
}

/* light color scheme: https://coolors.co/d3fc05-2b303a-f6f7eb-3abecf-7c7c7c */
body.light {
    background: #f6f7eb;
    color: #2B303A;
}

/* Thanks llogiq for the style inspiration! */
.wrapper {
    width: 860px;
    margin: 0 auto;
}

@media print, screen and (max-width: 960px) {
    div.wrapper {
        width: auto;
        margin: 0;
    }
}

@media print, screen and (max-width: 720px) {
    body {
        word-wrap: break-word;
    }

    pre, code {
        word-wrap: normal;
    }
}

@media print, screen and (max-width: 480px) {
    body {
        padding: 15px;
    }

    h1 {
        font-size: 20pt;
    }

    h2 {
        font-size: 16pt;
    }

    h3 {
        font-size: 14pt;
    }
}

@media print {
    body {
        padding: 0.4in;
        font-size: 12pt;
        color: #444;
    }
}

a {
    transition: text-shadow 0.5s;
    color: #d6f1fc;
}

body.light a {
    color: #3abecf;
}

a:hover {
    text-shadow: 0 0 10px #a9cc66;
}

body.light a:hover {
    text-shadow: 0 0 10px #3abecf;
}

pre {
    background: #1D1F21;
    border: 1px solid #5C5C5C;
    border-radius: 5px;
}
code {
    background: #1D1F21;
    color: #0088FF;
    font-family: "Source Code Pro", monospace;
}
blockquote {
    background: #1D1F21;
    border-left: 3px solid #d3fc05;
}

body.light pre {
    background: #f6f7eb;
    color: #2B303A;
}

body.light blockquote {
    background: #f6f7eb;
    color: #2B303A;
    border-left: 3px solid #95f3ff;
}

body.light code {
    background: #f6f7eb;
    color: #3abecf;
}
body.light code.hljs {
    background: #1d1f21;
    color: #b6ced8;
}

blockquote > p {
    padding-bottom: 0.5em;
}
table {
    margin: 1em auto;
    border-collapse: collapse;
}
table, th, td {
    border: 1px solid #5C5C5C;
}
tr:hover {
    background: #1D1F21;
}
th {
    background: #1D1F21;
}
body.light tr:hover, body.light th {
    background: #f6f7eb;
}

small {
    /* slightly faded and dimmed version of the body text color */
    color: #a4a5a2;
}

body.light small {
    color: #404752;
}

header a, h1, h2, h3, h4, h5, h6 {
    font-family: Tahoma, Verdana, sans-serif;
}

.site-title-wrapper {
    width: 400px;
    display: inline-block;
}
.site-title {
    margin: 0;
}
.site-title a, .glow {
    color: #d3fc05;
    text-decoration: none;
    animation-name: radiate;
    animation-duration: 5s;
    animation-timing-function: ease-out;
    animation-iteration-count: infinite;
}

body.light .site-title a, body.light .glow {
    color: #3abecf;
    animation-name: radiate-light;
}

@keyframes radiate {
    0% { text-shadow: 0 0 2px #a9cc66; }
    50% { text-shadow: 0 0 30px #a9cc66; color: #f0fc05; }
    100% { text-shadow: 0 0 2px #a9cc66; }
}

@keyframes radiate-light {
    0% { text-shadow: 0 0 2px #95f3ff; }
    50% { text-shadow: 0 0 30px #95f3ff; }
    100% { text-shadow: 0 0 2px #95f3ff; }
}

.nav {
    margin: 10px 0;
    display: inline-block;
    vertical-align: top;
    cursor: pointer;
}

.nav a {
    color: #d3fc05;
    text-decoration: none;
}

body.light .nav a {
    color: #3abecf;
}

.post .content h1 {
    color: #d3fc05;
}
.post .content h2 {
    color: #d3fc05;
}
.post .content h3 {
    color: #d3fc05;
}
.post .content h4 {
    color: #d3fc05;
}
.post .content h5 {
    color: #d3fc05;
}
.post .content h6 {
    color: #d3fc05;
}
.post .title {
    color: #d3fc05;
    margin-bottom: 0;
}
.post .content a:hover {
    color: #d3fc05;
}
.social-link:hover {
    color: #d3fc05;
}
.nav-item-title:hover {
    color: #d3fc05;
}
.tag a:hover {
    color: #d3fc05;
}
.post-preview .title a {
    color: #d3fc05;
}
.content-item a:hover {
    text-decoration: underline;
    color: #d3fc05;
}
.post-list .title {
    color: #d3fc05;
}

.tombstone {
    color: #d3fc05;
}

body.light .post .content h1 {
    color: #3abecf;
}
body.light .post .content h2 {
    color: #3abecf;
}
body.light .post .content h3 {
    color: #3abecf;
}
body.light .post .content h4 {
    color: #3abecf;
}
body.light .post .content h5 {
    color: #3abecf;
}
body.light .post .content h6 {
    color: #3abecf;
}
body.light .post .title {
    color: #3abecf;
    margin-bottom: 0;
}
body.light .post .content a:hover {
    color: #3abecf;
}
body.light .social-link:hover {
    color: #3abecf;
}
body.light .nav-item-title:hover {
    color: #3abecf;
}
body.light .tag a:hover {
    color: #3abecf;
}
body.light .post-preview .title a {
    color: #3abecf;
}
body.light .content-item a:hover {
    text-decoration: underline;
    color: #3abecf;
}
body.light .post-list .title {
    color: #3abecf;
}

body.light .tombstone {
    color: #3abecf;
}

.inline {
    display: inline;
}

blockquote > p {
    margin-left: 10px;
}

.language-shell .hljs-meta {
    user-select: none; /* don't allow users to select $ in shell */
}

img:not([width]) { /* set images to take up the full width, unless I specify a width on them */
    width: 100%;
}

kbd {
    background-color: #444;
    color: #c8d1b8;
    padding: 4px 10px;
    border-radius: 4px;
    border: 3px solid #aaa;
}

.follow-up {
    background-color: #242424;
    color: #d2f495;
    padding: 0.5em;
}

            .hljs-comment,
.hljs-quote
{
  color: #456b7c; /* darker version of background */
}

.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion
{
  color: #5dcdfd; /* faded light blue */
}

.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link,
.hljs-subst
{
  color: #35ddff; /* bright aqua */
}

.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition
{
  color: #13CE00; /* verdant green */
}

.hljs-title,
.hljs-section,
.hljs-attribute
{
  color: #96FF00; /* yellow green */
}

.hljs-keyword,
.hljs-selector-tag
{
  color: #1ea8fc; /* cerulean */
}

.hljs
{
  display: block;
  overflow-x: auto;
  background: #19272d;
  color: #b6ced8;
  padding: 0.5em;
  font-family: "Source Code Pro", "Consolas", monospace;
}

.hljs-emphasis
{
  font-style: italic;
}

.hljs-strong
{
  font-weight: bold;
}

        </style>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap">
        <link rel="stylesheet" href="https://use.typekit.net/uvh1qwh.css">

        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body class="dark">
        <div class="wrapper">
            <header>
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a href="/">The Reactor Core</a>
                    </h1>
                    <small>Where the engineers hang out</small>
                </div>
                <h2 class="nav">
                    <a href="/about">About</a>
                </h2>
            </header>
            <hr />
            <main>
                <div class="post">
    <h1 class="title">8 - Ruby's Less Than Less Than Operator</h1>
    <small>Published 2020-06-18</small>
    <section class="content">
        <p>In the immortal words of <a href="https://www.destroyallsoftware.com/talks/wat">Gary Bernhardt</a>, let's talk about Ruby.</p>
<h1>Ruby</h1>
<p>Ruby is a beautiful language. In many ways, Ruby is Rust before Rust was ever conceived of:</p>
<ul>
<li>Ruby learned from a lot of the mistakes of languages before it</li>
<li>Ruby has a vibrant community, with a catchy, inclusive slogan: Matz (creator) is nice and so we are nice (MINASWAN)</li>
<li>Ruby is very opinionated about its library structure, and includes a utility to make installing dependencies easy (<code>gem</code>)</li>
<li>Ruby is &quot;designed for programmer happiness&quot;</li>
</ul>
<p>However, we can't stretch the metaphor too far. Ruby is dynamic, interpolated, object oriented, and (relatively) slow. It makes up for that last point by being incredibly good for prototyping, much the same as Python. It also takes many of the best parts (regexes in particular) from Perl, which dominated the internet for a time.</p>
<h2>The <code>&lt;&lt;</code> operator</h2>
<p>So Ruby's pretty awesome. But like every language, Ruby has warts, and you will see more of them the longer you look. I've been programming professionally (aka getting paid to write software) in Ruby for a little over 5 years now, and today I'd like to put one of my most frequent code review comments into a blog post I can point to.</p>
<p><strong>Don't use the <code>&lt;&lt;</code> operator in Ruby</strong></p>
<p>Here's why:</p>
<pre><code class="language-ruby">some_variable &lt;&lt; 'A string'
</code></pre>
<p>What is the type of <code>some_variable</code>, in this line? You could say, &quot;Well, that's an array.&quot; 9 times out of 10, you'd be right. Suppose it is an array. There are valid reasons to stick something onto the end of an array. The most frequent usage I see:</p>
<pre><code class="language-ruby">arr = []
iterable.each do |element|
  arr &lt;&lt; element.foo
end
</code></pre>
<p>is also an anti-pattern (you can collapse it into a single line and run faster and use less memory with map: <code>arr = iterable.map(&amp;:foo)</code>). But even supposing that this is one of those times, <code>&lt;&lt;</code> is a bad idea for a couple of reasons:</p>
<h3><code>&lt;&lt;</code> is a bad idea because it's hard to pronounce</h3>
<p>How do you say it in your head? In our above example, you can say &quot;Some variable ...... a string&quot;.</p>
<p>What do we put there?</p>
<p>Gets, from C++'s <code>cin.gets &lt;&lt; var</code>?<br>
Dot push, since <code>&lt;&lt;</code> is an alias (on <code>Array</code>) for <code>.push</code>?<br>
Dot append, if you come from Python?<br>
Less than less than, like I put as the title of this blog post?</p>
<p>Any of these are usable, but they're all compromises.</p>
<h3><code>&lt;&lt;</code> is a bad idea because it's hard to search</h3>
<p>If you put <code>ruby less than less than</code> into google, you'll get a few semi-relevant stack overflow posts, followed by a bunch of stuff on comparison:</p>
<p><img src="../img/search-less-than.png" alt="Ruby search for less than less than"></p>
<p>It's about the same on Duck Duck Go and slightly worse on Bing (the StackOverflows are down a few results).</p>
<h3><code>&lt;&lt;</code> is a bad idea because it requires context</h3>
<p>This is probably the strongest argument against <code>&lt;&lt;</code>. If you ever get into compiler theory, you'll hear about <a href="https://en.wikipedia.org/wiki/Context-free_grammar">context free grammars</a>. If you look at the wikipedia article I linked, you'll see a beautiful formal definition with graphs, fancy symbols, and absolutely no way to understand it at all.</p>
<p>A context free grammar, in practical terms, is one where you can look at a line of code by itself and understand what it's doing. To be clear, most of the languages we use are not context-free. They are contextual. Even English is contextual. If I tell you, &quot;Oh yeah, he went to the store,&quot; your first question will be &quot;Who?&quot; In this specific example, you need more information to fully understand that sentence.</p>
<p>In our earlier example:</p>
<pre><code class="language-ruby">some_variable &lt;&lt; 'A string'
</code></pre>
<p>you need more information (more <em>context</em>) to know what the type of some_variable is, and what's actually being done on it. There are at least 4 different possibilities here:</p>
<ul>
<li><code>some_variable</code> is an array, and you want to add this element to the end of the array.</li>
<li><code>some_variable</code> is a string, and you want to concatenate this object to the end of it (yes, you can concat numbers to strings)</li>
<li><code>some_variable</code> is a <a href="https://ruby-doc.org/stdlib-2.7.1/libdoc/csv/rdoc/CSV.html">CSV</a> and you want to add a row to it.</li>
<li><code>some_variable</code> is an <a href="https://ruby-doc.org/core-2.7.1/IO.html">IO</a> object, and you want to write to it.</li>
</ul>
<p>This is not even including that you can open up an instance of a class to define methods on it with <code>&lt;&lt;</code>, which is possibly the only legitimate use for it, and the thing that comes up in those StackOverflow posts:</p>
<pre><code class="language-ruby">class &lt;&lt; some_instance
  def foo
    puts 'why, though?'
  end
end

# some_instance.foo
# =&gt; why, though?
# =&gt; nil
</code></pre>
<h2>What do we do about it?</h2>
<p>Use the full names of things!</p>
<p>If you want to add an element to an array, use <a href="https://ruby-doc.org/core-2.7.1/Array.html#method-i-push">Array#push</a>. Not only is it more readable, <code>pop</code> is cleanly and obviously the opposite behavior. (Note: <code>+</code> on arrays does concatenation, and both arguments must be arrays)</p>
<p>If you want to concatenate two strings, use <code>+</code> or <code>+=</code>:</p>
<p><img src="../img/string-concat.png" alt="Use String concatenation with plus"></p>
<p>If you want to add a row to a CSV, use the appropriately named (though terribly documented) <a href="https://ruby-doc.org/stdlib-2.7.1/libdoc/csv/rdoc/CSV.html#method-i-add_row">CSV#add_row</a>.</p>
<p>If you want to write to an IO object (such as a file), use <a href="https://ruby-doc.org/core-2.7.1/IO.html#method-i-write">IO#write</a>.</p>
<h1>Summary</h1>
<p>This was my first rant about Ruby, though I doubt it will be my last. Tune in next time for mutable strings (fixed in Ruby 3!), <code>require 'English'</code>, and <code>.present?</code>. It will be a blast!</p>

        <span class="tombstone">&#9670;</span>
    </section>
</div>

            </main>
            <footer>
                <!-- TODO: Add some content to my footer -->
            </footer>
        </div>
    </body>
</html>
